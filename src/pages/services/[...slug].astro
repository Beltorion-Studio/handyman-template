---
import Layout from '@layouts/Layout.astro'
import Hero from '@components/sections/Hero.astro'
import CTA from '@components/CTA.astro'
import ContactUs from '@components/ContactUs.astro'
import ProcessTimeline from '@components/sections/ProcessTimeline.astro'
import { getCollection } from 'astro:content'
import { config } from '@config'
import type { CollectionEntry } from 'astro:content'

export async function getStaticPaths() {
  const services = await getCollection('services')
  return services.map((service) => ({
    params: { slug: service.id },
    props: { service },
  }))
}

type Props = {
  service: CollectionEntry<'services'>
}

const { service } = Astro.props

// Generate page title and description
const pageTitle = `${service.data.title} | ${config.site.name}`
---

<Layout title={pageTitle}>
  <Hero
    sectionId="service-hero"
    heroImage={{ src: service.data.heroImage, alt: service.data.imageAlt }}
    title={service.data.title}
    subheading={service.data.description}
    primaryButtonText="Get Free Quote"
    primaryButtonHref="#contact"
  />

  <CTA
    sectionId="service-cta"
    title={`Ready to Get Started with ${service.data.title}?`}
    description="Contact us today for a free consultation and estimate. We're here to help bring your vision to life."
    primaryButtonText="Get Free Quote"
    primaryButtonHref="#contact"
    backgroundClass="bg-gradient-to-br from-brand to-primary-dark"
  />



  <ContactUs sectionId="contact" title="Let's Discuss Your Project" />
</Layout>
  <ProcessTimeline
  sectionId="our-process"
  title="Our Process"
  steps={[
    {
      title: 'Rapid Response',
      description:
        'We provide quick response times for all service calls, with same-day service available for urgent plumbing issues.',
      image: { src: service.data.heroImage, alt: service.data.imageAlt }
    },
    {
      title: 'Thorough Diagnosis',
      description:
        'Our plumbers use advanced diagnostic tools to accurately identify plumbing problems and determine the most effective solutions.',
      image: { src: service.data.heroImage, alt: service.data.imageAlt }
    },
    {
      title: 'Quality Installation',
      description:
        'We use high-quality materials and proven installation techniques to ensure long-lasting, reliable plumbing repairs and installations.',
      image: { src: service.data.heroImage, alt: service.data.imageAlt }
    },
    {
      title: 'System Testing',
      description:
        'All work is thoroughly tested to ensure proper operation, water pressure, and leak-free connections.',
      image: { src: service.data.heroImage, alt: service.data.imageAlt }
    },
    {
      title: 'Cleanup & Warranty',
      description:
        'We clean up after every job and provide comprehensive warranties on all parts and labor.',
      image: { src: service.data.heroImage, alt: service.data.imageAlt }
    }
  ]}
/>