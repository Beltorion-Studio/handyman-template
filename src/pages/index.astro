---
import Layout from '@layouts/Layout.astro'
import CTA from '@components/CTA.astro'
import ContactUs from '@components/ContactUs.astro'
import Services from '@components/sections/Services.astro'
import PostsSection from '@components/sections/PostsSection.astro'
import heroImage from '@assets/images/installer-holding-shelf-w2000.jpg'
import { getCollection } from 'astro:content'
import HeroWithStats from '@components/sections/HeroWithStats.astro'
import SectionRegular from '@components/sections/SectionRegular.astro'
import SectionWithCarousel from '@components/sections/SectionWithCarousel.astro'
import OfferImg from '@assets/images/locksmith.jpg'
import Library1 from '@assets/images/modern-library-1.jpg'
import Library2 from '@assets/images/crossed-arms.jpg'
import Library3 from '@assets/images/installer-holding-shelf-w2000.jpg'
import AboutImg from '@assets/images/crossed-arms.jpg'
import Testimonial from '@components/Testimonial.astro'

// Get all services from content collection
const allServices = await getCollection('services')
const services = allServices.filter((service) => service.data.featured)

// Get testimonials from content collection
const testimonials = await getCollection('testimonial')

// Get blog posts from content collection
const allBlogPosts = await getCollection('blog')
const blogPosts = allBlogPosts.sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
---

<Layout title="Home">
  <HeroWithStats
    heroImage={{ src: heroImage, alt: 'Hero background image' }}
    title="@@Reliable Help@@ for Every Task"
    subheading="We are a team of experienced handymen who are dedicated to providing the best possible service to our clients."
    primaryButtonText="Get a Free Quote"
    primaryButtonHref="/contact"
    secondaryButtonText="Learn More"
    secondaryButtonHref="/services"
    sectionId='Handyman Home'
  />

  <Services sectionId="services" title="Our Services" services={services} />

  <CTA
    sectionId="Call to action"
    title="Ready to Fix It Today?"
    description="Don't wait for small problems to become big ones. Fill out our form now and let us make your home hassle-free."
    primaryButtonText="Get Your Free Quote"
    primaryButtonHref="/contact"
    backgroundClass="bg-gradient-to-br from-brand to-primary-dark"
  />

  <SectionRegular
    content={{
      sectionId: 'offer',
      badge: 'Offer',
      title: 'Why Homeowners Trust Us',
      paragraphs: {
        p1: 'Choosing the right handyman service makes all the difference. We understand that homeowners value reliability, efficiency, and clear communication. That’s why we focus on combining skilled craftsmanship with a professional, approachable attitude. Every project, big or small, is handled with care and attention to detail, ensuring results that last.',
        p2: 'Our team’s reputation is built on trust, experience, and happy customers who return again and again. With transparent pricing, punctual service, and a friendly approach, we turn everyday fixes into stress-free solutions. We don’t just complete tasks—we make your life easier.',
      },
      buttons: {
        primary: {
          text: 'Find Out More',
          href: '/about',
        },
      },
      image: {
        src: OfferImg,
        alt: 'managed it services transportation logistics',
        size: 'square',
      },
    }}
  />

  <Testimonial
    badgeText="Testimonials"
    ,
    title="What Our Clients Say"
    ,
    sectionId="testimonials"
    ,
    testimonials={testimonials}
  />

  <SectionWithCarousel
    content={{
      sectionId: 'Our Latest Project',
      badge: 'Our Latest Project',
      title: 'University Library',
      paragraphs: {
        p1: 'Our recent project involved renovating the University Library. We assembled modern furniture, installed parquet flooring, painted walls for a fresh look, and replaced outdated light fixtures.',
        p2: 'The result? A polished and professional space that balances function and style, giving employees and students a welcoming environment.',
      },
      buttons: {
        primary: {
          text: 'View All Works',
          href: '/works',
        },
      },
      image: {
        src: Library1,
        alt: 'University Library renovation project',
        size: 'square',
      },
    }}
    carouselImages={[
      {
        src: Library1,
        alt: 'University Library renovation - main view',
      },
      {
        src: Library2,
        alt: 'University Library renovation - team at work',
      },
      {
        src: Library3,
        alt: 'University Library renovation - final result',
      },
    ]}
    sectionId="our-latest-project"
  />

  <CTA
    sectionId="Call to action"
    title="Let’s Get Your Project Started"
    primaryButtonText="Contact Us Today"
    primaryButtonHref="/contact"
    backgroundClass="bg-gradient-to-br from-brand to-primary-dark"
  />

  <SectionRegular
    content={{
      sectionId: 'About',
      reverse: true,
      badge: 'About',
      title: 'Meet the Team Behind the Tools',
      paragraphs: {
        p1: 'At the heart of our work is Daniel Harris, a skilled handyman with a passion for solving everyday problems.',
        p2: 'With years of experience across trades, he built a service dedicated to reliability, creativity, and care.',
        p3: 'We believe every home and office deserves professional attention delivered with warmth and efficiency.',
        p4: 'Our mission is simple: to take the stress out of repairs, improvements, and installations.',
      },
      buttons: {
        primary: {
          text: 'Find out More',
          href: '/about',
        },
      },
      image: {
        src: AboutImg,
        alt: 'Daniel Harris — founder',
        size: 'square',
      },
    }}
  />

  <PostsSection
    badge="Blog"
    title="Latest Blog Posts"
    buttonText="View All Posts"
    buttonHref="/blog"
    posts={blogPosts}
    postType="blog"
    maxPosts={3}
    sectionId="latest-blog-posts"
    background='bg-gradient-to-br from-primary-light/5 to-brand/5'
  />

  <ContactUs sectionId="contact-us" title="Let's Talk About Your Needs" />
</Layout>
