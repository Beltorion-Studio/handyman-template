---
import Layout from '@layouts/Layout.astro'
import Hero from '@components/sections/Hero.astro'
import heroImage from '@assets/images/electrician-in-safety-helmet.jpg'
import PostsSection from '@components/sections/PostsSection.astro'
import CTA from '@components/CTA.astro'
import Testimonial from '@components/Testimonial.astro'
import ContactUs from '@components/ContactUs.astro'
import { getCollection } from 'astro:content'

// Get all services from content collection
const allServices = await getCollection('services')
const services = allServices.filter((service) => service.data.featured)

// Get testimonials from content collection
const testimonials = await getCollection('testimonial')
---

<Layout title="Home">
  <Hero
    sectionId="hero"
    heroImage={{ src: heroImage, alt: 'Hero background image' }}
    title="@@Services@@ for Every Home"
  />

  <PostsSection
    posts={services}
    postType="services"
    sectionId="otherServices"
  />

  <CTA
    sectionId="Call to action"
    title="Ready to Fix It Today?"
    description="Don't wait for small problems to become big ones. Fill out our form now and let us make your home hassle-free."
    primaryButtonText="Get Your Free Quote"
    primaryButtonHref="#contact-us"
    backgroundClass="bg-gradient-to-br from-brand to-primary-dark"
  />

  <Testimonial
    badgeText="Testimonials"
    ,
    title="What Our Clients Say"
    ,
    sectionId="testimonials"
    ,
    testimonials={testimonials}
  />

  <ContactUs sectionId="contact-us" title="Let's Talk About Your Needs" />
</Layout>
